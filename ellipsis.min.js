!function(){"use strict";function a(a){var d=c(b,a||{});this.create(d)}var b={ellipsis:"â€¦",debounce:100,responsive:!0,class:".clamp",lines:2,portrait:null,break_word:!0},c=function(a,b){var c={};for(var d in a)c[d]=a[d];for(var e in b)c[e]=b[e];return c};a.prototype={conf:{},prop:{},lines:{},temp:null,cloneCache:function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c].innerHTML);return b},create:function(a){if(this.conf=a,this.lines={get current(){return a.portrait&&window.innerHeight>window.innerWidth?a.portrait:a.lines}},this.conf.responsive){this.temp=this.cloneCache(document.querySelectorAll(this.conf.class));var b,c=function(a){clearTimeout(b),b=setTimeout(function(){this.add()}.bind(this),this.conf.debounce)};window.addEventListener("resize",c.bind(this),!1),window.removeEventListener("beforeunload",c.bind(this),!1)}this.add()},add:function(){for(var a=document.querySelectorAll(this.conf.class),b=0;b<a.length;b++)this.conf.responsive&&this.temp&&this.temp[b]!=a[b].innerHTML&&(a[b].innerHTML=this.temp[b]),this.prop={get height(){return parseInt(getComputedStyle(a[b]).getPropertyValue("height"),10)},get lineheight(){var c=getComputedStyle(a[b]).getPropertyValue("line-height");return String("normal|initial|inherit").indexOf(c)>-1&&(c=parseInt(getComputedStyle(a[b]).getPropertyValue("font-size"),10)+2),parseInt(c,10)}},this.isNotCorrect()&&(a[b].childNodes.length&&a[b].childNodes.length>1?this.handleChilds(a[b]):a[b].childNodes.length&&1===a[b].childNodes.length&&3===a[b].childNodes[0].nodeType&&this.simpleText(a[b]))},breakWord:function(a,b,c){var d=a.split(" ");if(d.pop(),c&&d.pop(),!b)return d[d.length-1]&&(d[d.length-1]=d[d.length-1].replace(/(,$)/g,"").replace(/(\.$)/g,"")),d.push(this.conf.ellipsis),d.join(" ");if(d[d.length-1])return d[d.length-1]=d[d.length-1].replace(/(,$)/g,"").replace(/(\.$)/g,""),d.push(this.conf.ellipsis),[d.join(" "),b];if(!d[d.length-1]&&b){var b=" "+b.trim().replace(/(,$)/g,"").replace(/(\.$)/g,"")+" ";return d.push(this.conf.ellipsis),[d.join(" "),b]}},simpleText:function(a){for(var b=a.childNodes[0].nodeValue;this.prop.height>this.prop.lineheight*this.lines.current;)a.childNodes[0].nodeValue=b.slice(0,-1),b=a.childNodes[0].nodeValue;this.conf.break_word?(a.childNodes[0].nodeValue=b.slice(0,-this.conf.ellipsis.length)+this.conf.ellipsis,this.isNotCorrect()&&(a.childNodes[0].nodeValue=" "+a.childNodes[0].nodeValue.slice(0,-(this.conf.ellipsis.length+1)).trim().slice(0,-this.conf.ellipsis.length)+this.conf.ellipsis)):(a.childNodes[0].nodeValue=this.breakWord(a.childNodes[0].nodeValue),this.isNotCorrect()&&(a.childNodes[0].nodeValue=this.breakWord(a.childNodes[0].nodeValue,null,!0)))},isNotCorrect:function(){return this.prop.height>this.prop.lineheight*this.lines.current},processBreak:function(a,b,c){var d=this.breakWord(a.innerHTML||a.nodeValue,b.innerHTML||b.nodeValue,c);a.innerHTML?a.innerHTML=d[0]:a.nodeValue=d[0],b.innerHTML?b.innerHTML=d[1]:b.nodeValue=d[1]},handleChilds:function(a){for(var b=a.childNodes,c=b.length-1;c>=0;c--){var d;if(3===b[c].nodeType?(d=b[c].nodeValue,b[c].nodeValue=""):(d=getComputedStyle(b[c]).getPropertyValue("display"),b[c].style.display="none"),this.prop.height<=this.prop.lineheight*this.lines.current){if(3===b[c].nodeType){b[c].nodeValue=d;for(var e=b[c].nodeValue;this.prop.height>this.prop.lineheight*this.lines.current;)b[c].nodeValue=e.slice(0,-1),e=b[c].nodeValue;if(this.conf.break_word){if(b[c].nodeValue=e.slice(0,-this.conf.ellipsis.length)+this.conf.ellipsis,this.isNotCorrect()){if(b[c].nodeValue=" "+b[c].nodeValue.slice(0,-this.conf.ellipsis.length).trim().slice(0,-this.conf.ellipsis.length),!(b[c].nodeValue.length>1))continue;b[c].nodeValue=b[c].nodeValue.slice(0,-this.conf.ellipsis.length)+this.conf.ellipsis}}else{if(!b[c].innerHTML&&!b[c].nodeValue)continue;if(this.processBreak(b[c],b[c-1]),this.isNotCorrect()&&(this.processBreak(b[c],b[c-1],!0),this.isNotCorrect())){a.removeChild(b[c]);continue}}}else{b[c].style.display=d;for(var e=b[c].innerHTML;this.prop.height>this.prop.lineheight*this.lines.current;)b[c].innerHTML=e.slice(0,-1),e=b[c].innerHTML;if(this.conf.break_word){if(b[c].innerHTML=e.slice(0,-this.conf.ellipsis.length)+this.conf.ellipsis,this.isNotCorrect()){if(b[c].innerHTML=" "+b[c].innerHTML.slice(0,-this.conf.ellipsis.length).trim().slice(0,-this.conf.ellipsis.length),!(b[c].innerHTML.length>1))continue;b[c].innerHTML=b[c].innerHTML.slice(0,-this.conf.ellipsis.length)+this.conf.ellipsis}}else{if(!b[c].innerHTML&&!b[c].nodeValue)continue;if(this.processBreak(b[c],b[c-1]),this.isNotCorrect()&&(this.processBreak(b[c],b[c-1],!0),this.isNotCorrect())){a.removeChild(b[c]);continue}}}break}a.removeChild(b[c])}}};var d=function(b){return new a(b)};return"function"==typeof define&&define.amd&&define("ellipsis",[],function(){return d}),self.Ellipsis=d,d}();